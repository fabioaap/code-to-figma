
> @figma-sync-engine/storybook-addon-export@0.1.0 test /home/runner/work/code-to-figma/code-to-figma/figma-sync-engine/packages/storybook-addon-export
> vitest run --passWithNoTests


[7m[1m[36m RUN [39m[22m[27m [36mv1.6.1[39m [90m/home/runner/work/code-to-figma/code-to-figma/figma-sync-engine/packages/storybook-addon-export[39m

 [32mâœ“[39m src/logger.test.ts [2m ([22m[2m24 tests[22m[2m)[22m[90m 25[2mms[22m[39m
 [32mâœ“[39m src/variantMapper.test.ts [2m ([22m[2m32 tests[22m[2m)[22m[90m 29[2mms[22m[39m
 [32mâœ“[39m src/export.test.ts [2m ([22m[2m40 tests[22m[2m)[22m[90m 84[2mms[22m[39m
[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if clipboard unavailable[22m[39m
[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould copy JSON to clipboard[22m[39m
[2025-11-24T04:13:26.086Z] ERROR: export.failed {
  method: 'clipboard',
[2025-11-24T04:13:26.081Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.082Z] INFO: export.completed { method: 'clipboard', size: 41, duration: 1 }

  error: 'Clipboard API not available',
[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould format JSON with indentation[22m[39m
[2025-11-24T04:13:26.084Z] INFO: export.started { method: 'clipboard' }
  duration: 0
[2025-11-24T04:13:26.084Z] INFO: export.completed { method: 'clipboard', size: 75, duration: 0 }

}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould include timestamp[22m[39m
[2025-11-24T04:13:26.085Z] INFO: export.started { method: 'clipboard' }
[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if write fails[22m[39m
[2025-11-24T04:13:26.085Z] INFO: export.completed { method: 'clipboard', size: 21, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if clipboard unavailable[22m[39m
[2025-11-24T04:13:26.088Z] ERROR: export.failed { method: 'clipboard', error: 'Permission denied', duration: 0 }
[2025-11-24T04:13:26.086Z] INFO: export.started { method: 'clipboard' }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if write fails[22m[39m
[2025-11-24T04:13:26.088Z] INFO: export.started { method: 'clipboard' }


[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould calculate correct file size[22m[39m
[2025-11-24T04:13:26.089Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.089Z] INFO: export.completed { method: 'clipboard', size: 44, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould download file with default name[22m[39m
[2025-11-24T04:13:26.090Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-24T04:13:26.102Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 12
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould download file with custom name[22m[39m
[2025-11-24T04:13:26.103Z] INFO: export.started { method: 'download', filename: 'my-button.json' }
[2025-11-24T04:13:26.105Z] INFO: export.completed {
  method: 'download',
  filename: 'my-button.json',
  size: 21,
  duration: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould create blob and URL[22m[39m
[2025-11-24T04:13:26.106Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-24T04:13:26.108Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould clean up URL after download[22m[39m
[2025-11-24T04:13:26.108Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-24T04:13:26.110Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould handle large JSON[22m[39m
[2025-11-24T04:13:26.111Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-24T04:13:26.113Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 5641,
  duration: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould use clipboard when available[22m[39m
[2025-11-24T04:13:26.114Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.114Z] INFO: export.completed { method: 'clipboard', size: 21, duration: 0 }

[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould fallback to download if clipboard fails[22m[39m
[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould fallback to download if clipboard fails[22m[39m
[2025-11-24T04:13:26.116Z] ERROR: export.failed { method: 'clipboard', error: 'No permission', duration: 0 }
[2025-11-24T04:13:26.115Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.116Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-24T04:13:26.117Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 1

}
[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould use custom filename in fallback[22m[39m

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould use custom filename in fallback[22m[39m
[2025-11-24T04:13:26.118Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.119Z] INFO: export.started { method: 'download', filename: 'custom-name.json' }
[2025-11-24T04:13:26.129Z] INFO: export.completed {
  method: 'download',
  filename: 'custom-name.json',
  size: 21,
[2025-11-24T04:13:26.118Z] ERROR: export.failed { method: 'clipboard', error: 'No permission', duration: 0 }

  duration: 10
}

[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould throw if both methods fail[22m[39m
[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould throw if both methods fail[22m[39m
[2025-11-24T04:13:26.130Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.130Z] ERROR: export.failed {
[2025-11-24T04:13:26.130Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mEdge cases[2m > [22m[2mshould handle very large JSON[22m[39m
  method: 'clipboard',
  error: 'Clipboard API not available',
[2025-11-24T04:13:26.143Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.155Z] INFO: export.completed { method: 'clipboard', size: 103041, duration: 12 }

  duration: 0
}
[2025-11-24T04:13:26.131Z] ERROR: export.failed {
  method: 'download',
  filename: 'figma-export.json',
  error: 'URL error',
  duration: 0
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mEdge cases[2m > [22m[2mshould handle special characters in content[22m[39m
[2025-11-24T04:13:26.156Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.157Z] INFO: export.completed { method: 'clipboard', size: 80, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mEdge cases[2m > [22m[2mshould handle empty children array[22m[39m
[2025-11-24T04:13:26.157Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.157Z] INFO: export.completed { method: 'clipboard', size: 39, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mVAR-1 Integration[2m > [22m[2mshould export component with variants to clipboard[22m[39m
[2025-11-24T04:13:26.159Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.159Z] INFO: export.completed { method: 'clipboard', size: 153, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mVAR-1 Integration[2m > [22m[2mshould include original args in __export metadata[22m[39m
[2025-11-24T04:13:26.160Z] INFO: export.started { method: 'clipboard' }
[2025-11-24T04:13:26.160Z] INFO: export.completed { method: 'clipboard', size: 370, duration: 0 }

[90mstderr[2m | VirtualConsole.forward (/home/runner/work/code-to-figma/code-to-figma/figma-sync-engine/node_modules/.pnpm/jsdom@27.2.0/node_modules/jsdom/lib/jsdom/virtual-console.js:28:20)[22m[39m
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document

 [32mâœ“[39m src/captureHtml.test.ts [2m ([22m[2m14 tests[22m[2m)[22m[33m 1332[2mms[22m[39m

[2m Test Files [22m [1m[32m4 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[32m110 passed[39m[22m[90m (110)[39m
[2m   Start at [22m 04:13:25
[2m   Duration [22m 3.23s[2m (transform 214ms, setup 0ms, collect 275ms, tests 1.47s, environment 2.43s, prepare 548ms)[22m

