
> @figma-sync-engine/storybook-addon-export@0.1.0 test /home/runner/work/code-to-figma/code-to-figma/figma-sync-engine/packages/storybook-addon-export
> vitest run --passWithNoTests


[7m[1m[36m RUN [39m[22m[27m [36mv1.6.1[39m [90m/home/runner/work/code-to-figma/code-to-figma/figma-sync-engine/packages/storybook-addon-export[39m

 [32mâœ“[39m src/logger.test.ts [2m ([22m[2m24 tests[22m[2m)[22m[90m 25[2mms[22m[39m
[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould copy JSON to clipboard[22m[39m
[2025-11-23T07:35:30.353Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.355Z] INFO: export.completed { method: 'clipboard', size: 41, duration: 2 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould format JSON with indentation[22m[39m
[2025-11-23T07:35:30.358Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.358Z] INFO: export.completed { method: 'clipboard', size: 75, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould include timestamp[22m[39m
[2025-11-23T07:35:30.360Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.360Z] INFO: export.completed { method: 'clipboard', size: 21, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if clipboard unavailable[22m[39m
[2025-11-23T07:35:30.361Z] INFO: export.started { method: 'clipboard' }

[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if clipboard unavailable[22m[39m
[2025-11-23T07:35:30.361Z] ERROR: export.failed {
  method: 'clipboard',
  error: 'Clipboard API not available',
  duration: 0
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if write fails[22m[39m
[2025-11-23T07:35:30.364Z] INFO: export.started { method: 'clipboard' }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould calculate correct file size[22m[39m
[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToClipboard[2m > [22m[2mshould throw error if write fails[22m[39m
[2025-11-23T07:35:30.366Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.365Z] ERROR: export.failed { method: 'clipboard', error: 'Permission denied', duration: 1 }
[2025-11-23T07:35:30.366Z] INFO: export.completed { method: 'clipboard', size: 44, duration: 0 }


[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould download file with default name[22m[39m
[2025-11-23T07:35:30.367Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-23T07:35:30.385Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 18
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould download file with custom name[22m[39m
[2025-11-23T07:35:30.389Z] INFO: export.started { method: 'download', filename: 'my-button.json' }
[2025-11-23T07:35:30.391Z] INFO: export.completed {
  method: 'download',
  filename: 'my-button.json',
  size: 21,
  duration: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould create blob and URL[22m[39m
[2025-11-23T07:35:30.393Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-23T07:35:30.395Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould clean up URL after download[22m[39m
[2025-11-23T07:35:30.396Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-23T07:35:30.397Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportToFile[2m > [22m[2mshould handle large JSON[22m[39m
[2025-11-23T07:35:30.398Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-23T07:35:30.401Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 5641,
  duration: 3
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould use clipboard when available[22m[39m
[2025-11-23T07:35:30.402Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.403Z] INFO: export.completed { method: 'clipboard', size: 21, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould fallback to download if clipboard fails[22m[39m
[2025-11-23T07:35:30.403Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.404Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }
[2025-11-23T07:35:30.405Z] INFO: export.completed {
  method: 'download',
  filename: 'figma-export.json',
  size: 21,
  duration: 1
}

[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould fallback to download if clipboard fails[22m[39m
[2025-11-23T07:35:30.404Z] ERROR: export.failed { method: 'clipboard', error: 'No permission', duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould use custom filename in fallback[22m[39m
[2025-11-23T07:35:30.406Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.406Z] INFO: export.started { method: 'download', filename: 'custom-name.json' }
[2025-11-23T07:35:30.407Z] INFO: export.completed {
  method: 'download',
  filename: 'custom-name.json',
  size: 21,
  duration: 1
}

[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould use custom filename in fallback[22m[39m
[2025-11-23T07:35:30.406Z] ERROR: export.failed { method: 'clipboard', error: 'No permission', duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould throw if both methods fail[22m[39m
[2025-11-23T07:35:30.407Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.408Z] INFO: export.started { method: 'download', filename: 'figma-export.json' }

[90mstderr[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mexportWithFallback[2m > [22m[2mshould throw if both methods fail[22m[39m
[2025-11-23T07:35:30.407Z] ERROR: export.failed {
  method: 'clipboard',
  error: 'Clipboard API not available',
  duration: 0
}
[2025-11-23T07:35:30.408Z] ERROR: export.failed {
  method: 'download',
  filename: 'figma-export.json',
  error: 'URL error',
  duration: 0
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mEdge cases[2m > [22m[2mshould handle very large JSON[22m[39m
[2025-11-23T07:35:30.422Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.430Z] INFO: export.completed { method: 'clipboard', size: 103041, duration: 8 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mEdge cases[2m > [22m[2mshould handle special characters in content[22m[39m
[2025-11-23T07:35:30.431Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.431Z] INFO: export.completed { method: 'clipboard', size: 80, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mEdge cases[2m > [22m[2mshould handle empty children array[22m[39m
[2025-11-23T07:35:30.432Z] INFO: export.started { method: 'clipboard' }
[2025-11-23T07:35:30.432Z] INFO: export.completed { method: 'clipboard', size: 39, duration: 0 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportWithColorTokens[2m > [22m[2mshould extract color tokens from JSON[22m[39m
[2025-11-23T07:35:30.433Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.434Z] INFO: export.colorsExtracted { colorCount: 1, tokens: [ 'red' ] }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportWithColorTokens[2m > [22m[2mshould add colorToken references to fills[22m[39m
[2025-11-23T07:35:30.434Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.435Z] INFO: export.colorsExtracted { colorCount: 1, tokens: [ 'red' ] }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportWithColorTokens[2m > [22m[2mshould handle JSON without colors[22m[39m
[2025-11-23T07:35:30.435Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.435Z] INFO: export.colorsExtracted { colorCount: 0, tokens: [] }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportToClipboardWithColors[2m > [22m[2mshould copy JSON with color tokens[22m[39m
[2025-11-23T07:35:30.436Z] INFO: export.started { method: 'clipboard', withColors: true }
[2025-11-23T07:35:30.436Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.436Z] INFO: export.colorsExtracted { colorCount: 1, tokens: [ 'red' ] }
[2025-11-23T07:35:30.437Z] INFO: export.completed { method: 'clipboard', size: 469, duration: 0, colorTokensCount: 1 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportToClipboardWithColors[2m > [22m[2mshould include colorTokensCount in result[22m[39m
[2025-11-23T07:35:30.437Z] INFO: export.started { method: 'clipboard', withColors: true }
[2025-11-23T07:35:30.437Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.438Z] INFO: export.colorsExtracted { colorCount: 2, tokens: [ 'red', 'green' ] }
[2025-11-23T07:35:30.438Z] INFO: export.completed { method: 'clipboard', size: 712, duration: 0, colorTokensCount: 2 }

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportToFileWithColors[2m > [22m[2mshould download JSON with color tokens[22m[39m
[2025-11-23T07:35:30.439Z] INFO: export.started { method: 'download', filename: 'test-colors.json', withColors: true }
[2025-11-23T07:35:30.439Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.439Z] INFO: export.colorsExtracted { colorCount: 1, tokens: [ 'blue' ] }
[2025-11-23T07:35:30.440Z] INFO: export.completed {
  method: 'download',
  filename: 'test-colors.json',
  size: 472,
  duration: 2,
  colorTokensCount: 1
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportToFileWithColors[2m > [22m[2mshould create proper JSON structure[22m[39m
[2025-11-23T07:35:30.441Z] INFO: export.started { method: 'download', filename: 'text-test.json', withColors: true }
[2025-11-23T07:35:30.441Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.441Z] INFO: export.colorsExtracted { colorCount: 1, tokens: [ 'white' ] }
[2025-11-23T07:35:30.443Z] INFO: export.completed {
  method: 'download',
  filename: 'text-test.json',
  size: 349,
  duration: 2,
  colorTokensCount: 1
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportToSeparateFiles[2m > [22m[2mshould export colors.json and figma.json separately[22m[39m
[2025-11-23T07:35:30.444Z] INFO: export.started { method: 'download', mode: 'separate', baseFilename: 'test' }
[2025-11-23T07:35:30.444Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.444Z] INFO: export.colorsExtracted { colorCount: 2, tokens: [ 'white', 'black' ] }
[2025-11-23T07:35:30.449Z] INFO: export.completed {
  method: 'download',
  mode: 'separate',
  filesCount: 2,
  duration: 6,
  colorTokensCount: 2
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportToSeparateFiles[2m > [22m[2mshould include color count in colors.json result[22m[39m
[2025-11-23T07:35:30.451Z] INFO: export.started { method: 'download', mode: 'separate', baseFilename: 'figma-export' }
[2025-11-23T07:35:30.451Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.451Z] INFO: export.colorsExtracted { colorCount: 3, tokens: [ 'red', 'green', 'blue' ] }
[2025-11-23T07:35:30.454Z] INFO: export.completed {
  method: 'download',
  mode: 'separate',
  filesCount: 2,
  duration: 2,
  colorTokensCount: 3
}

[90mstdout[2m | src/export.test.ts[2m > [22m[2mexport - MVP-5[2m > [22m[2mColor Token Export - TOK-1[2m > [22m[2mexportToSeparateFiles[2m > [22m[2mshould handle JSON with no colors[22m[39m
[2025-11-23T07:35:30.454Z] INFO: export.started { method: 'download', mode: 'separate', baseFilename: 'figma-export' }
[2025-11-23T07:35:30.454Z] INFO: export.extractingColors { hasContent: true }
[2025-11-23T07:35:30.454Z] INFO: export.colorsExtracted { colorCount: 0, tokens: [] }
[2025-11-23T07:35:30.455Z] INFO: export.completed {
  method: 'download',
  mode: 'separate',
  filesCount: 1,
  duration: 1,
  colorTokensCount: 0
}

 [32mâœ“[39m src/export.test.ts [2m ([22m[2m46 tests[22m[2m)[22m[90m 109[2mms[22m[39m
[90mstderr[2m | src/export.test.ts[22m[39m
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document
Not implemented: navigation to another Document

 [32mâœ“[39m src/captureHtml.test.ts [2m ([22m[2m14 tests[22m[2m)[22m[33m 1439[2mms[22m[39m

[2m Test Files [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[32m84 passed[39m[22m[90m (84)[39m
[2m   Start at [22m 07:35:28
[2m   Duration [22m 2.83s[2m (transform 327ms, setup 1ms, collect 442ms, tests 1.57s, environment 2.43s, prepare 585ms)[22m

